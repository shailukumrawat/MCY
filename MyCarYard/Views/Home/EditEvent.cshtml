@model MyCarYard.Models.ApproveUserListModel
@{
    ViewBag.Title = "Edit Event";
    Layout = "~/Views/Shared/_LayoutOuterUser.cshtml";
}
<link href="@Url.Content("~/Css/bootstrap-datetimepicker.min.css")" rel="stylesheet">
<script>
    var geocoder;
    var map; var marker;
    function mapa() {
        geocoder = new google.maps.Geocoder();
        if(@Model.approveeventlist[0].late!="" && @Model.approveeventlist[0].lonz!=""){
            var opts = {
                'center': new google.maps.LatLng(@Model.approveeventlist[0].late, @Model.approveeventlist[0].lonz),
                'zoom': 11, 'mapTypeId': google.maps.MapTypeId.ROADMAP
            }
            map = new google.maps.Map(document.getElementById('mapdiv'), opts);
        }
        google.maps.event.addListener(map, 'click', function (event) {

            placeMarker(event.latLng);
            //document.getElementById('latlongclicked').value = event.latLng.lat() + ', ' + event.latLng.lng()
            $('#late').val(event.latLng.lat())
            $('#long').val(event.latLng.lng())
        })

        google.maps.event.addListener(map, 'mousemove', function (event) {
            //alert("Hi");
            //$('#latitute').val(event.latLng.lat())
            //$('#longitute').val(event.latLng.lng())
            // document.getElementById('latlong').innerHTML = event.latLng.lat() + ', ' + event.latLng.lng()
        });

    }

    function placeMarker(location) {

        if (marker == null) {
            marker = new google.maps.Marker({
                position: location,
                map: map
            });
        } else { marker.setPosition(location); }
    }

    function codeAddress() {
        if(@Model.approveeventlist[0].late!="" && @Model.approveeventlist[0].lonz!=""){
            geocoder = new google.maps.Geocoder();
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(@Model.approveeventlist[0].late, @Model.approveeventlist[0].lonz),
                map: map,
                title: 'Your Location'
            });
            var opts = {
                'center': new google.maps.LatLng(@Model.approveeventlist[0].late, @Model.approveeventlist[0].lonz),
                'zoom': 5, 'mapTypeId': google.maps.MapTypeId.ROADMAP
            }
        }
        else{
            var address = $("#country option:selected").text();
            geocoder.geocode({ 'address': address }, function (results, status) {
                if (status == 'OK') {
                    map.setZoom(5);
                    map.setCenter(results[0].geometry.location);

                } else {
                    //alert('Geocode was not successful for the following reason: ' + status);
                }
            });
        }
    }
</script>
<div class="col-sm-7">
    <div class="mngevnt_contain map_contain">
        <div class="detail_head event_head">
            <h4 class="detail_heading">Edit Event Here </h4>
        </div>
        <div class="describe_contain">
            <h4 class="seller_head">Event Images</h4>
            <div class="row">
                <div class="col-sm-12">
                    <form action="EditEventPic" method="post" enctype="multipart/form-data" id="uploadeventpic" name="frm1">
                        <div class="event_upload">
                            <ul>
                                <li>
                                    <i class="flaticon1-arrows"> </i>
                                    <a href="#" data-toggle="modal" class="event_upldnew" id="img" data-id="0" data-target="#imgcrop_modal"></a>
                                    Upload Event Image Here 1
                                    <img id="output0" class="upload_img" src="~/images/events/@Model.approveeventlist[0].img">
                                    <input type="hidden" id="hdoutput0" name="hdoutput0" />
                                </li>
                                <li>
                                    <i class="flaticon1-arrows"> </i>
                                    <a href="#" data-toggle="modal" class="event_upldnew" id="img1" name="img1" data-id="1" data-target="#imgcrop_modal"></a>
                                    Upload Event Image Here 2
                                    <img id="output1" class="upload_img" src="~/images/events/@Model.approveeventlist[0].img1">
                                    <input type="hidden" id="hdoutput1" name="hdoutput1" value="" />
                                </li>
                                <li>
                                    <i class="flaticon1-arrows"> </i>
                                    <a href="#" data-toggle="modal" class="event_upldnew" id="img2" name="img2" data-id="2" data-target="#imgcrop_modal"></a>
                                    Upload Event Image Here 3
                                    <img id="output2" class="upload_img" src="~/images/events/@Model.approveeventlist[0].img2">
                                    <input type="hidden" id="hdoutput2" name="hdoutput2" value="" />
                                </li>
                            </ul>
                        </div>
                        <input type="hidden" id="eventid" value="@Model.approveeventlist[0].eid" name="eventid" />
                    </form>

                </div>
                <div class="col-sm-12">
                    <h4 class="seller_head">Event Details</h4>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" class="form-control" placeholder="Title" id="title" value="@Model.approveeventlist[0].title" required>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Category</label>
                        <select class="form-control " id="category" required>
                            <option value="0">Select Category</option>
                        </select>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="form-group">
                        <label><input type="checkbox" id="issponsorship" @(Model.approveeventlist[0].sponsorship.Equals("1") ? Html.Raw("checked") : null)> Is the event Sponsored?</label>
                        @*<select class="form-control " id="sponsorship" required>
                                @if (Model.approveeventlist[0].sponsorship == "0")
                                {
                                    <option value="0" selected>Yes</option>

                                    <option value="1">No</option>
                                }
                                else
                                {
                                    <option value="0">Yes</option>

                                    <option value="1" selected>No</option>
                                }
                            </select>*@
                    </div>
                </div>
                <div class="col-sm-6" @(Model.approveeventlist[0].sponsorship.Equals("0") ? Html.Raw("hidden") : null) " id="sponsorshipbox">
                    <div class="form-group">
                        <label>Sponsorship Name</label>
                        <input type="text" class="form-control" placeholder="Sponsorship Name" id="sponsorshipname" value="@Model.approveeventlist[0].sponsorname" required>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="form-group">
                        <label><input type="checkbox" id="ispaid" @(Model.approveeventlist[0].ispaid.Equals(1) ? Html.Raw("checked") : null)> Entry Fee</label>
                    </div>
                </div>


                <div class="col-sm-6 @(Model.approveeventlist[0].ispaid.Equals(0) ? Html.Raw("hidden"):null)" id="pricebox">
                    <div class="form-group">
                        <label>Price</label>
                        <input type="text" placeholder="Price " class="form-control" id="price" value="@Model.approveeventlist[0].price">
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="form-group">
                        <label>Overview</label>
                        <textarea class="form-control" placeholder="Event subject (Maximum 4000 Words)" id="subject" required maxlength="4000" onkeyup='charLimit(this, 4000);'>@Model.approveeventlist[0].subject</textarea>
                    </div>
                </div>

                <script>
                    function charLimit(limitField, limitNum) {
                        if (limitField.value.length > limitNum) {
                            limitField.value = limitField.value.substring(0, limitNum);
                        }
                    }


                </script>

                <div class="col-sm-12">
                    <h4 class="seller_head">Time and Date</h4>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Date</label>

                        <div class="input-group date form_date" data-date="" data-date-format="MM dd  yyyy" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                            <input type="text" class="form-control" placeholder="Select Date" id="date" required readonly value="@Model.approveeventlist[0].date">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                        </div>
                        <input type="hidden" id="dtp_input2" value="" />
                    </div>

                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Time</label>

                        <div class="input-group date form_time" data-date-format="hh:ii P" data-link-field="dtp_input3" data-link-format="hh:ii">
                            <input type="text" class="form-control" placeholder="Select Time" id="time" required readonly value="@Model.approveeventlist[0].time">

                            <span class="input-group-addon"><span class="glyphicon glyphicon-time"></span></span>
                        </div>
                        <input type="hidden" id="dtp_input3" value="" />
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Contact Number</label>
                        <input type="number" placeholder="Contact Details" class="form-control" id="cno" value="@Model.approveeventlist[0].cno" required>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="form-group my_fmg">
                        <label><input type="checkbox" id="showphone" @(Model.approveeventlist[0].showphone.Equals(1) ? Html.Raw("checked") : null)> Tick to show contact number?</label>
                    </div>
                </div>

                <div class="col-sm-12">
                    <h4 class="seller_head">Location</h4>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Country</label>
                        <select class="form-control " onchange="loadtable(); loadCity(); loadReason(); loadNewRegion();" id="country" required>
                            <option value="0">Select Country</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>State</label>
                        <select class="form-control " id="state" onchange="loadCity(); loadReason(); loadNewRegion();" required>
                            <option value="0">Select State</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>City</label>
                        <select class="form-control " id="city" onchange="loadReason(); loadNewRegion();" required>
                            <option value="0">Select City</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Suburb</label>
                        <select class="form-control " id="reason" required>
                            <option value="0">Select Suburb</option>
                        </select>
                    </div>
                </div>
                @*<div class="col-sm-6">
                                    <div class="form-group">
                                        <label>Suburb</label>
                                        <select class="form-control " id="suburb" required>
                                            <option value="0">Select Suburb</option>
                                        </select>

                    <input type="text" placeholder="Suburb" class="form-control" id="suburb" value="@Model.approveeventlist[0].suburb">
                                    </div>
                                </div>*@
                <div class="col-sm-6" style="display:none;">
                    <div class="form-group">
                        <label>Post Code</label>
                        <input type="number" placeholder="Post Code" class="form-control" id="code" value="@Model.approveeventlist[0].code" required>
                    </div>
                </div>
                <div class="col-sm-6" style="display:none;">
                    <div class="form-group">
                        <label>Unit/Building</label>
                        <input type="text" placeholder="Unit/Building" class="form-control" id="unit" value="@Model.approveeventlist[0].unit" required>
                    </div>
                </div>
                <div class="col-sm-6" style="display:none;">
                    <div class="form-group">
                        <label>Street</label>
                        <input type="text" placeholder="Street #" class="form-control" id="street" value="@Model.approveeventlist[0].street" required>
                    </div>
                </div>
                <div class="col-sm-6" style="display:none;">
                    <div class="form-group">
                        <label>Street Name</label>
                        <input type="text" placeholder="Street Name" class="form-control" id="sname" value="@Model.approveeventlist[0].sname" required>
                    </div>
                </div>
                <div class="col-sm-6" style="display:none;">
                    <div class="form-group">
                        <label>Latitude</label>
                        <input type="text" placeholder="Event Latitude" class="form-control" id="late" value="@Model.approveeventlist[0].late" required>
                    </div>
                </div>
                <div class="col-sm-6" style="display:none;">
                    <div class="form-group">
                        <label>Longitude</label>
                        <input type="text" placeholder="Event Longitude " class="form-control" id="long" value="@Model.approveeventlist[0].lonz" required>
                    </div>
                </div>
                <input type="hidden" id="currency" />

                <div class="col-sm-12">
                    <div class="form-group">
                        <label>Street and post code</label>
                        <input type="text" placeholder="Street and post code" class="form-control" id="streetpostcode" value="@Model.approveeventlist[0].address">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Status</label>
                        @*<select class="form-control " id="status">
                                <option value="">Select Status</option>
                                @if (Model.approveeventlist[0].status == 1)
                                {
                                    <option value="1" selected>Activate</option>
                                    <option value="0">Deactivate</option>
                                }
                                else
                                {
                                    <option value="1">Activate</option>
                                    <option value="0" selected>Deactivate</option>

                                }
                            </select>*@
                        @if (Model.approveeventlist[0].status == 1)
                        {
                            <input type="text" class="form-control" value="Activate" disabled>
                        }
                        else
                        {<input type="text" class="form-control" value="Deactivate" disabled>
                        }
                    </div>
                </div>

                <div class="col-sm-12">

                    <div class="form-group">

                        <div id="mapdiv" style="width:100%;height:400px;"></div>

                        <script async defer
                                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCx0DvT12bYe8a4xIw_SivGa2gIoqSYacI&callback=mapa">
                        </script>

                    </div>

                </div>
                <div class="col-sm-12">
                    <div class="form-group">
                        <input type="hidden" class="form-control" id="descr" />
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="map_btn">
                        <button class="cmn_btn" onclick="EditEvent();">Update </button>

                    </div>
                </div>

            </div>
        </div>

    </div>
</div>

<script type="text/javascript">

    var ispaid = '@Model.approveeventlist[0].ispaid';
    $("#ispaid").change(function () {
        if (this.checked) {
            ispaid = 1;

            $('#pricebox').removeClass('hidden');
        } else {
            ispaid = 0;
            $('#pricebox').addClass('hidden');

        }
    });
    var sponsorship = '@Model.approveeventlist[0].sponsorship';
    $("#issponsorship").change(function () {
        if (this.checked) {

            sponsorship = 1;
            $('#sponsorshipbox').show();
            // $('#currencybox').show();

        } else {
            sponsorship = 0;
            $('#sponsorshipbox').hide();
            // $('#currencybox').hide();
        }
    });
    function EditEvent() {

        try {
            var isvalid = true;
            var eid = '@Model.approveeventlist[0].eid';

            var category = $("#category").val();
            if (category == "0") {

                /* lnv.alert({
                     title: ' ',
                     content: 'Please Select Category',
                     alertBtnText: 'Okay',
                     alertHandler: function () {
                         $('#category').focus();
                     }
                 })*/
                $('#category').css('border-color', 'red');
                isvalid = false;

            } else {

                $('#category').css('border-color', '');
                isvalid = true;
            }

            var title = $("#title").val();
            //alert(title);
            if (title.trim() == "") {

                /*lnv.alert({
                    title: ' ',
                    content: 'Please Enter Title',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $('#title').focus();
                    }
                })*/
                $('#title').css('border-color', 'red');
                isvalid = false;
            } else {
                $('#title').css('border-color', '');
                isvalid = true;
            }
            var subject = $("#subject").val();
            //alert(subject);
            if (subject.trim() == "") {


                /*lnv.alert({
                    title: ' ',
                    content: 'Please Enter Subject',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $('#subject').focus();
                    }
                })*/
                $('#subject').css('border-color', 'red');
                isvalid = false;
            } else {

                $('#subject').css('border-color', '');
                isvalid = true;
            }

            var date = $("#date").val();
            if (date.trim() == "") {


                /*
                lnv.alert({
                    title: ' ',
                    content: 'Please Enter Date',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $('#date').focus();
                    }
                })*/
                $('#date').css('border-color', 'red');
                isvalid = false;

            } else {

                $('#date').css('border-color', '');
                isvalid = true;
            }
            var time = $("#time").val();
            ///alert(time);
            if (time.trim() == "") {


                /* lnv.alert({
                     title: ' ',
                     content: 'Please Enter Time',
                     alertBtnText: 'Okay',
                     alertHandler: function () {
                         $('#time').focus();
                     }
                 })*/
                $('#time').css('border-color', 'red');
                isvalid = false;
            } else {

                $('#time').css('border-color', '');
                isvalid = true;
            }

            var cno = $("#cno").val();
            if (cno.trim() == "") {


                /*  lnv.alert({
                      title: ' ',
                      content: 'Please Enter Contact Number',
                      alertBtnText: 'Okay',
                      alertHandler: function () {
                          $('#cno').focus();
                      }
                  })*/
                $('#cno').css('border-color', 'red');
                isvalid = false;
            } else {
                $('#cno').css('border-color', '');

                isvalid = true;
            }
            //alert(cno);
            var country = $("#country").val();
            if (country == "0") {


                /*lnv.alert({
                    title: ' ',
                    content: 'Please Enter Country',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $('#country').focus();
                    }
                })*/
                $('#country').css('border-color', 'red');
                isvalid = false;
            } else {

                $('#country').css('border-color', '');
                isvalid = true;
            }
            //alert(country);
            var state = $("#state").val();
            if (state == "0") {

                /*lnv.alert({
                    title: ' ',
                    content: 'Please Select State',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $('#state').focus();
                    }
                })*/
                $('#state').css('border-color', 'red');
                isvalid = false;

            } else {

                $('#state').css('border-color', '');
                isvalid = true;
            }
            ///alert(state);
            var city = $("#city").val();
            if (city == "0") {


                /*  lnv.alert({
                      title: ' ',
                      content: 'Please Select City',
                      alertBtnText: 'Okay',
                      alertHandler: function () {
                          $('#city').focus();
                      }
                  })*/
                $('#city').css('border-color', 'red');
                isvalid = false;
            } else {
                $('#city').css('border-color', '');
                isvalid = true;
            }
            //alert(city);
            var reason = $("#reason").val();
            //alert(reason);
            if (reason == "0") {



                /*
                lnv.alert({
                    title: ' ',
                    content: 'Please Select Suburb',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $('#reason').focus();
                    }
                })*/
                $('#reason').css('border-color', 'red');
                isvalid = false;

            } else {

                $('#reason').css('border-color', '');
                isvalid = true;
            }
            //var suburb = $("#suburb").val();
            //alert(suburb);
            /*if (suburb == "0") {


                $('#suburb').css('border-color', 'red');
                isvalid = false;
            } else {

                $('#suburb').css('border-color', '');
                isvalid = true;
            }*/


            //var code = $("#code").val();
            ////alert(code);
            //if (code == "") {

            //    /*
            //    lnv.alert({
            //        title: ' ',
            //        content: 'Please Enter Code',
            //        alertBtnText: 'Okay',
            //        alertHandler: function () {
            //            $('#code').focus();
            //        }
            //    })*/
            //    $('#code').css('border-color', 'red');
            //    isvalid = false;
            //} else {
            //    $('#code').css('border-color', '');
            //    isvalid = true;
            //}
            //var unit = $("#unit").val();
            //if (unit.trim() == "") {



            //    /*lnv.alert({
            //        title: ' ',
            //        content: 'Please Enter Unit/Building',
            //        alertBtnText: 'Okay',
            //        alertHandler: function () {
            //            $('#unit').focus();
            //        }
            //    })*/
            //    $('#unit').css('border-color', 'red');
            //    isvalid = false;
            //} else {

            //    $('#unit').css('border-color', '');
            //    isvalid = true;
            //}
            //var street = $("#street").val();
            //if (street.trim() == "") {


            //    /*lnv.alert({
            //        title: ' ',
            //        content: 'Please Enter Street',
            //        alertBtnText: 'Okay',
            //        alertHandler: function () {
            //            $('#street').focus();
            //        }
            //    })*/
            //    $('#street').css('border-color', 'red');
            //    isvalid = false;
            //} else {
            //    $('#street').css('border-color', '');
            //    isvalid = true;
            //}

            ////alert(street);
            //var sname = $("#sname").val();
            ////alert(sname);
            //if (sname.trim() == "") {


            //    /*lnv.alert({
            //        title: ' ',
            //        content: 'Please Street Name',
            //        alertBtnText: 'Okay',
            //        alertHandler: function () {
            //            $('#sname').focus();
            //        }
            //    })*/
            //    $('#sname').css('border-color', 'red');
            //    isvalid = false;
            //} else {
            //    $('#sname').css('border-color', '');
            //    isvalid = true;
            //}


            var descr = "Hi";
            //alert(descr);
            /*   if (descr == "") {

                   lnv.alert({
                       title: ' ',
                       content: 'Please Enter Description',
                       alertBtnText: 'Okay',
                       alertHandler: function () {
                           $('#descr').focus();
                       }
                   })
                   return false;
               }*/
            var late = $("#late").val();
            //if (late.trim() == "") {

            //    /*  lnv.alert({
            //          title: ' ',
            //          content: 'Please Select Location from Map',
            //          alertBtnText: 'Okay',
            //          alertHandler: function () {
            //              //$('#sname1').focus();
            //          }
            //      })*/
            //    $('#late').css('border-color', 'red');
            //    isvalid = false;
            //} else {

            //    $('#late').css('border-color', '');
            //    isvalid = true;
            //}


            var long = $("#long").val();
            //if (long.trim() == "") {



            //    /*lnv.alert({
            //        title: ' ',
            //        content: 'Please Select Position from MAP',
            //        alertBtnText: 'Okay',
            //        alertHandler: function () {
            //            //$('#sname1').focus();
            //        }
            //    })*/
            //    $('#long').css('border-color', 'red');
            //    isvalid = false;
            //} else {
            //    $('#long').css('border-color', '');
            //    isvalid = true;
            //}

            var showphonenew = '@Model.approveeventlist[0].showphone';
            var price = 0;


            var isprice = $('#ispaid:checked').val();

            if (isprice == "on") {
                //alert("Hello");

                if ($('#price').val() == "0" || $('#price').val() == "") {

                    /* lnv.alert({
                         title: ' ',
                         content: 'Please Enter Price',
                         alertBtnText: 'Okay',
                         alertHandler: function () {
                             $('#price').focus();
                         }
                     })*/
                    $('#price').css('border-color', 'red');
                    isvalid = false;

                } else {

                    price = $('#price').val();
                    isvalid = true;
                    $('#price').css('border-color', '');
                }
                // return false;
            }

            var showphone = $('#showphone:checked').val();

            if (showphone == "on") {


                showphonenew = "1";
            }
            else {

                showphonenew = "0";
            }
            var sponsorshipname=null;
            var sponsorship = $('#issponsorship:checked').val();
            if (sponsorship == "on") {
                sponsorship = "1";
                sponsorshipname = $('#sponsorshipname').val();
            }
            else {

                sponsorship = "0";
            }
            var listid = '@Model.approveeventlist[0].listingid';

            // var sponsorship = $('#sponsorship').val();
            var streetpostcode = $('#streetpostcode').val();
            if (streetpostcode.trim() == "") {
                $('#streetpostcode').css('border-color', 'red');
                isvalid = false;
            } else {
                $('#streetpostcode').css('border-color', '');
                isvalid = true;
            }

            //if (category == "0" || title.trim() == "" || subject.trim() == "" || date.trim() == "" || time.trim() == "" || cno.trim() == "" || country == "0" || state == "0" || city == "0" || reason == "0" || code == "" || unit.trim() == "" || street.trim() == "" || sname.trim() == "" || late.trim() == "" || long.trim() == "") {
            if (category == "0" || title.trim() == "" || subject.trim() == "" || date.trim() == "" || time.trim() == "" || cno.trim() == "" || country == "0" || state == "0" || city == "0" || reason == "0" ||streetpostcode.trim() == "") {
                lnv.alert({
                    title: ' ',
                    content: 'Please Update red cells',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                    }
                });
                $('.alert-btn').focus();
                isvalid = false;
            }

            if (isvalid == true) {
                var objTest={}
                //var obj = { "eid": eid, "title": $("#title").val(), "subject": $("#subject").val(), "date": $("#date").val(), "time": $("#time").val(), "cno": $("#cno").val(), "country": $("#country").val(), "state": $("#state").val(), "city": $("#city").val(), "reason": $("#reason").val(), "code": $("#code").val(), "unit": $("#unit").val(), "street": $("#street").val(), "sname": $("#sname").val(), "descr": $("#descr").val(), "late": $("#late").val(), "lonz": $("#long").val(), "cat": $("#category").val(), "price": price, "ispaid": ispaid, "status": $('#status').val(), "showphone": showphonenew, "listid": listid, "sponsorship": sponsorship };
                objTest={ "eid": eid, "title": $("#title").val(), "subject": $("#subject").val(), "date": $("#date").val(), "time": $("#time").val(), "address": streetpostcode, "cno": $("#cno").val(), "country": $("#country").val(), "state": $("#state").val(), "city": $("#city").val(), "reason": $("#reason").val(), "descr": $("#descr").val(), "late": $("#late").val(), "lonz": $("#long").val(), "cat": $("#category").val(), "price": price, "ispaid": ispaid, "showphone": showphonenew, "listid": listid, "sponsorship": sponsorship ,"sponsorname": sponsorshipname};
                console.log(JSON.stringify(objTest));
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: '/Home/EditEvent',
                    data: JSON.stringify(objTest),
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        if (response.status == "Success") {

                            lnv.alert({
                                title: ' ',
                                content: 'Event Updated Successfully',
                                alertBtnText: 'Okay',
                                alertHandler: function () {
                                    $body = $("body");
                                    $body.addClass("loading");
                                    $('#uploadeventpic').submit();

                                }
                            });
                            $('.alert-btn').focus();

                        }
                    },
                    error: function () {
                        //alert("Error");
                    }
                });

            } else {



            }
        } catch (e) {


        }
    }
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>

    $(document).ready(function () {


        $('select').on('change', function () {
            if (this.value != "0" || this.value != "")
                $(this).css('border-color', '');
            else
                $(this).css('border-color', 'red');
        })


        $("input,textarea")
      .keyup(function () {
          var value = $(this).val();
          if (value != "")
              $(this).css('border-color', '');
          else
              $(this).css('border-color', 'red');
      })
        //.keyup();

    });



</script>
<script>
    var loadFile = function (event) {
        var fileUpload = $("#img")[0];

        var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(.jpg|.png|.gif)$");

        if (regex.test(fileUpload.value.toLowerCase())) {
            //Check whether HTML5 is supported.
            if (typeof (fileUpload.files) != "undefined") {
                //Initiate the FileReader object.
                var reader = new FileReader();
                //Read the contents of Image File.
                reader.readAsDataURL(fileUpload.files[0]);
                reader.onload = function (e) {
                    //Initiate the JavaScript Image object.
                    var image = new Image();
                    //Set the Base64 string return from FileReader as source.
                    image.src = e.target.result;
                    image.onload = function () {
                        //Determine the Height and Width.
                        var height = this.height;
                        var width = this.width;
                        if (height < 747 || width < 406) {
                            //alert("");
                            lnv.alert({
                                title: '',
                                content: 'Height and Width should be greater then 747*406',
                                alertBtnText: 'Okay',
                                alertHandler: function () {
                                    $("#img").focus();
                                }
                            });
                            $('.alert-btn').focus();
                            isvalid = false;
                        } else {
                            var output = document.getElementById('output');
                            output.src = URL.createObjectURL(event.target.files[0]);

                        }


                        //alert("Uploaded image has valid Height and Width.");
                        return true;
                    };
                }
            } else {
                //alert("");
                lnv.alert({
                    title: '',
                    content: 'This browser does not support HTML5.',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $("#img").focus();
                    }
                });
                $('.alert-btn').focus();
                return false;
            }

        } else {
            // alert("Please select a valid Image file.");
            lnv.alert({
                title: '',
                content: 'Please select a valid Image 1',
                alertBtnText: 'Okay',
                alertHandler: function () {
                    $("#img").focus();
                }
            });
            $('.alert-btn').focus();

            return false;
        }
    };
</script>
<script>
    var loadFile1 = function (event) {
        var fileUpload1 = $("#img1")[0];

        var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(.jpg|.png|.gif)$");

        if (regex.test(fileUpload1.value.toLowerCase())) {
            //Check whether HTML5 is supported.
            if (typeof (fileUpload1.files) != "undefined") {
                //Initiate the FileReader object.
                var reader = new FileReader();
                //Read the contents of Image File.
                reader.readAsDataURL(fileUpload1.files[0]);
                reader.onload = function (e) {
                    //Initiate the JavaScript Image object.
                    var image = new Image();
                    //Set the Base64 string return from FileReader as source.
                    image.src = e.target.result;
                    image.onload = function () {
                        //Determine the Height and Width.
                        var height = this.height;
                        var width = this.width;
                        if (height < 747 || width < 406) {
                            //alert("");
                            lnv.alert({
                                title: '',
                                content: 'Height and Width should be greater then 747*406',
                                alertBtnText: 'Okay',
                                alertHandler: function () {
                                    $("#img1").focus();
                                }
                            });
                            $('.alert-btn').focus();
                            isvalid = false;
                        } else {
                            var output = document.getElementById('output1');
                            output.src = URL.createObjectURL(event.target.files[0]);
                        }


                        //alert("Uploaded image has valid Height and Width.");
                        return true;
                    };
                }
            } else {
                //alert("");
                lnv.alert({
                    title: '',
                    content: 'This browser does not support HTML5.',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $("#img1").focus();
                    }
                });
                $('.alert-btn').focus();
                return false;
            }

        } else {
            // alert("Please select a valid Image file.");
            lnv.alert({
                title: '',
                content: 'Please select a valid Image 2',
                alertBtnText: 'Okay',
                alertHandler: function () {
                    $("#img1").focus();
                }
            });
            $('.alert-btn').focus();
            return false;
        }

    };
</script>
<script>
    var loadFile2 = function (event) {
        var fileUpload2 = $("#img2")[0];

        var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(.jpg|.png|.gif)$");

        if (regex.test(fileUpload2.value.toLowerCase())) {
            //Check whether HTML5 is supported.
            if (typeof (fileUpload2.files) != "undefined") {
                //Initiate the FileReader object.
                var reader = new FileReader();
                //Read the contents of Image File.
                reader.readAsDataURL(fileUpload2.files[0]);
                reader.onload = function (e) {
                    //Initiate the JavaScript Image object.
                    var image = new Image();
                    //Set the Base64 string return from FileReader as source.
                    image.src = e.target.result;
                    image.onload = function () {
                        //Determine the Height and Width.
                        var height = this.height;
                        var width = this.width;
                        if (height < 747 || width < 406) {
                            //alert("");
                            lnv.alert({
                                title: '',
                                content: 'Height and Width should be greater then 747*406',
                                alertBtnText: 'Okay',
                                alertHandler: function () {
                                    $("#img2").focus();
                                }
                            });
                            $('.alert-btn').focus();
                            isvalid = false;
                        } else {
                            var output = document.getElementById('output2');
                            output.src = URL.createObjectURL(event.target.files[0]);
                        }


                        //alert("Uploaded image has valid Height and Width.");
                        return true;
                    };
                }
            } else {
                //alert("");
                lnv.alert({
                    title: '',
                    content: 'This browser does not support HTML5.',
                    alertBtnText: 'Okay',
                    alertHandler: function () {
                        $("#img2").focus();
                    }
                });
                $('.alert-btn').focus();
                return false;
            }

        } else {
            // alert("Please select a valid Image file.");
            lnv.alert({
                title: '',
                content: 'Please select a valid Image 3',
                alertBtnText: 'Okay',
                alertHandler: function () {
                    $("#img2").focus();
                }
            });
            $('.alert-btn').focus();

            return false;
        }
    };
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $body = $("body");
        $body.addClass("loading");
        loadCat();
    });

    function loadCat() {
        var catid = '@Model.approveeventlist[0].cat';
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            //url is the path of our web method (Page name/function name)
            dataType: "json",
            url: '/Admin/LoadEventCat',
            asyn: false,
            cache: false,
            //called on jquery ajax call success
            success: function (result) {

                $('#category').empty();
                $("#category").append($("<option></option>").val("0").html("Select Category"));
                for (var i = 0; i <= result.catlist.length - 1 ; i++) {

                    if (result.catlist[i].status == "1") {
                        if (result.catlist[i].ecat_id == catid) {

                            $("#category").append($("<option selected></option>").val(result.catlist[i].ecat_id).html(result.catlist[i].category));


                        } else {

                            $("#category").append($("<option></option>").val(result.catlist[i].ecat_id).html(result.catlist[i].category));
                        }
                    }

                }
                $body.removeClass("loading");
            },
            //called on jquery ajax call failure
            error: function ajaxError(result) {
                $('#category').empty();
                $("#category").append($("<option></option>").val("").html("Select Category"));
            }
        });
    }
</script>






<script type="text/javascript">
    $(document).ready(function () {
        loadCountry();
    });

    function loadCountry() {

        $body = $("body");
        $body.addClass("loading");

        var countryid = '@Model.approveeventlist[0].country';
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            //url is the path of our web method (Page name/function name)
            dataType: "json",
            url: '/Home/GetCountry',
            asyn: false,
            cache: false,
            //called on jquery ajax call success
            success: function (result) {
                $('#country').empty();
                //  $('#country').append("<option value='0'>--Select--</option>");
                $("#country").append($("<option></option>").val("").html("Select Country"));
                for (var i = 0; i <= result.countrylist.length - 1 ; i++) {

                    if (result.countrylist[i].status == "1") {

                        if (result.countrylist[i].count_id == countryid) {

                            $("#country").append($("<option selected></option>").val(result.countrylist[i].count_id).html(result.countrylist[i].countryname));

                            loadtable();

                        } else {
                            $("#country").append($("<option></option>").val(result.countrylist[i].count_id).html(result.countrylist[i].countryname));

                        }

                        // $("#tblDetails").append("<tr><td>" + j + "</td><td>" + result.countrylist[i].countryname + "</td><td>" + result.countrylist[i].status + "</td><td> <img src=@Url.Content("~/Content/admin/edit.gif") onclick=FetchCountry('" + result.countrylist[i].count_id + "')></a></td><td><img src=@Url.Content("~/Content/admin/delete.gif") ></td></tr>");
                    }
                }

                $body.removeClass("loading");
            },
            //called on jquery ajax call failure
            error: function ajaxError(result) {
                $('#country').empty();
                //  $('#country').append("<option value='0'>--Select--</option>");
                $("#country").append($("<option></option>").val("").html("Select Country"));
            }
        });

    }

</script>
.
<script type="text/javascript">
    function loadtable() {
        $body = $("body");
        $body.addClass("loading");
        codeAddress();
        var count_id = $('#country option:selected').val();
        var stateid = '@Model.approveeventlist[0].state';
        //  alert(count_id);
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            //url is the path of our web method (Page name/function name)
            dataType: "json",
            data: "{ count_id: '" + $("#country").val() + "' }",
            url: '/Home/GetState',
            asyn: false,
            cache: false,
            //called on jquery ajax call success
            success: function (result) {
                $('#state').empty();
                $("#state").append($("<option></option>").val("").html("Select State"));
                for (var i = 0; i <= result.statelist.length - 1 ; i++) {

                    if (result.statelist[i].status == "1") {

                        if (result.statelist[i].state_id == stateid) {

                            $("#state").append($("<option selected></option>").val(result.statelist[i].state_id).html(result.statelist[i].state));

                            loadCity();
                        } else {
                            $("#state").append($("<option></option>").val(result.statelist[i].state_id).html(result.statelist[i].state));
                        }

                    }
                }
            },
            //called on jquery ajax call failure
            error: function ajaxError(result) {
                $('#state').empty();
                $("#state").append($("<option></option>").val("").html("Select State"));
            }

        });
        loadCurrency($("#country").val());
        $body.removeClass("loading");
    }

</script>

<script type="text/javascript">
    function loadCity() {
        // var make = $('#make option:selected').val();
        //  alert(count_id);


        $body = $("body");
        $body.addClass("loading");

        var cityid = '@Model.approveeventlist[0].city';
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            //url is the path of our web method (Page name/function name)
            dataType: "json",
            data: "{ country: '" + $("#country").val() + "',state:'" + $("#state").val() + "' }",
            url: '/Admin/LoadCity',
            asyn: false,
            cache: false,
            //called on jquery ajax call success
            success: function (result) {
                $('#city').empty();
                $("#city").append($("<option></option>").val("").html("Select City"));
                for (var i = 0; i <= result.citylist.length - 1; i++) {

                    if (result.citylist[i].status == "1") {
                        if (result.citylist[i].city_id == cityid) {

                            $("#city").append($("<option selected></option>").val(result.citylist[i].city_id).html(result.citylist[i].city));

                            loadReason();

                        } else {

                            $("#city").append($("<option></option>").val(result.citylist[i].city_id).html(result.citylist[i].city));
                        }

                    }
                }
                $body.removeClass("loading");
            },
            //called on jquery ajax call failure
            error: function ajaxError(result) {
                $('#city').empty();
                $("#city").append($("<option></option>").val("").html("Select City"));
            }
        });
    }
</script>
<script type="text/javascript">
    function loadReason() {
        $body = $("body");
        $body.addClass("loading");
        // var make = $('#make option:selected').val();
        //  alert(count_id);
        var regnid = '@Model.approveeventlist[0].reason';
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            //url is the path of our web method (Page name/function name)
            dataType: "json",
            data: "{ country: '" + $("#country").val() + "',state:'" + $("#state").val() + "' ,city:'" + $("#city").val() + "'}",
            url: '/Admin/LoadReason',
            asyn: false,
            cache: false,
            //called on jquery ajax call success
            success: function (result) {
                $('#reason').empty();
                $("#reason").append($("<option></option>").val("0").html("Select Suburb"));
                for (var i = 0; i <= result.reasonlist.length - 1; i++) {
                    if (result.reasonlist[i].status == "1") {
                        if (regnid == result.reasonlist[i].reas_id) {
                            $("#reason").append($("<option selected></option>").val(result.reasonlist[i].reas_id).html(result.reasonlist[i].reason));
                            loadNewRegion();

                        } else {
                            $("#reason").append($("<option></option>").val(result.reasonlist[i].reas_id).html(result.reasonlist[i].reason));
                        }
                    }
                }
                $body.removeClass("loading");
            },
            //called on jquery ajax call failure
            error: function ajaxError(result) {
                $('#reason').empty();
                $("#reason").append($("<option></option>").val("").html("Select Region"));
            }
        });
    }
</script>
<script type="text/javascript">
    function loadNewRegion() {
        $body = $("body");
        $body.addClass("loading");
        // var make = $('#make option:selected').val();
        //  alert(count_id);
        // var suburbid = $('#suburbid').val();
        // var regionid = $('#regionid').val();
        //alert(regionid);
        var suburbid = '@Model.approveeventlist[0].suburb'
        //alert(suburbid);
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            //url is the path of our web method (Page name/function name)
            dataType: "json",
            data: "{ country: '" + $("#country").val() + "',state:'" + $("#state").val() + "',city: '" + $('#city').val() + "',region: '" + $('#reason').val() + "' }",
            url: '/Admin/LoadNewRegion',
            asyn: false,
            cache: false,
            //called on jquery ajax call success
            success: function (result) {

                $('#suburb').empty();
                $("#suburb").append($("<option value='0'>Select Suburb</option>"));

                for (var i = 0; i <= result.newregionlist.length - 1 ; i++) {
                    if (result.newregionlist[i].status == 1) {
                        if (result.newregionlist[i].regionid == parseInt(suburbid)) {
                            $("#suburb").append($("<option selected></option>").val(result.newregionlist[i].regionid).html(result.newregionlist[i].regionname));
                        } else {

                            $("#suburb").append($("<option></option>").val(result.newregionlist[i].regionid).html(result.newregionlist[i].regionname));
                        }
                    }
                }


            },
            //called on jquery ajax call failure
            error: function ajaxError(result) {
                $('#suburb').empty();
                $("#suburb").append($("<option>Select Region</option>"));

            }
        });

        $body.removeClass("loading");
    }
</script>
<script>
    function loadCurrency(countid) {
        $body = $("body");
        $body.addClass("loading");
        // alert("hi");
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            //url is the path of our web method (Page name/function name)
            dataType: "json",
            url: '/Admin/LoadCurrency',
            asyn: false,
            cache: false,
            //called on jquery ajax call success
            success: function (result) {
                // $('#currency').empty();
                //$("#currency").append($("<option selected></option>").val("").html("Select Currency"));
                for (var i = 0; i <= result.currencylist.length - 1 ; i++) {
                    if (result.currencylist[i].count_id == countid) {

                        $("#currency").val(result.currencylist[i].cur_id);
                    }

                }
            },
            //called on jquery ajax call failure
            error: function ajaxError(result) {

            }
        });

        $body.removeClass("loading");
    }
</script>
<script src="@Url.Content("~/Css/bootstrap-datetimepicker.min.js")"></script>
<script type="text/javascript">
    $('.form_time').datetimepicker({
        language: 'fr',
        weekStart: 1,
        todayBtn: 1,
        autoclose: 1,
        todayHighlight: 1,
        startView: 1,
        minView: 0,
        maxView: 1,
        forceParse: 0
    });
</script>
<script type="text/javascript">
    $(".form_date").datetimepicker({
        format: 'mm/dd/yyyy',
        language: 'fr',
        weekStart: 1,
        todayBtn: 1,
        autoclose: 1,
        startDate: '-3d',
        todayHighlight: 1,
        startView: 2,
        minView: 2,
        forceParse: 0
    });
</script>

<style>
    .cropit-preview {
        background-color: #f8f8f8;
        background-size: cover;
        border: 5px solid #ccc;
        border-radius: 3px;
        margin-top: 7px;
        width: 663px;
        height: 400px;
    }

    .cropit-preview-image-container {
        cursor: move;
    }

    .cropit-preview-background {
        opacity: .2;
        cursor: auto;
    }

    .image-size-label {
        margin-top: 10px;
    }

    input, .export {
        /* Use relative position to prevent from being covered by image background */
        position: relative;
        z-index: 10;
        display: block;
    }

    button {
        margin-top: 10px;
    }
</style>
<div id="imgcrop_modal" class="modal fade" role="dialog">
    <div class="modal-dialog login_dilog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <div class="login_head">Image Crop <div id="popupclose" class="close">x</div></div>
            </div>
            <div class="modal-body">
                <div class="image-editor">
                    <div id="ImageErrorMessage" class="text-danger hide"> </div>
                    <input type="file" id="fucrop" class="cropit-image-input select-image-btn" accept=".png,.jpg,.jpeg,.gif" />

                    <div class="cropit-preview" id="cropdiv"></div>
                    <div class="image-size-label">
                        Resize image
                    </div>
                    <input type="range" id="croprange" class="cropit-image-zoom-input">
                    <button class="rotate-ccw">Rotate counterclockwise</button>
                    <button class="rotate-cw">Rotate clockwise</button>
                    <button class="export">Export</button>
                </div>
            </div>
        </div>

    </div>
</div>
<script>
    $(function () {
        $("input:file").change(function () {
            //Get reference of FileUpload.
            var fileUpload = $("#fucrop")[0];

            //Check whether the file is valid Image.
            var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(.jpg|.png|.gif)$");
            if (regex.test(fileUpload.value.toLowerCase())) {
                //Check whether HTML5 is supported.
                if (typeof (fileUpload.files) != "undefined") {
                    //Initiate the FileReader object.
                    var reader = new FileReader();
                    //Read the contents of Image File.
                    reader.readAsDataURL(fileUpload.files[0]);
                    reader.onload = function (e) {
                        //Initiate the JavaScript Image object.
                        var image = new Image();
                        //Set the Base64 string return from FileReader as source.
                        image.src = e.target.result;
                        image.onload = function () {
                            //Determine the Height and Width.
                            var height = this.height;
                            var width = this.width;
                            if (height < 550 || width < 850) {
                                $('#ImageErrorMessage').removeClass("hide").text("Failed to upload Image, should be width 820px and height 500px.");
                                return false;
                            }
                            $('#ImageErrorMessage').removeClass("hide").text("");
                            return true;
                        };
                    }
                } else {
                    alert("This browser does not support HTML5.");
                    return false;
                }
            } else {
                //alert("Please select a valid Image file.");
                $('#ImageErrorMessage').removeClass("hide").text("Failed to upload Image, the format is not supported.");

                return false;
            }
        });
    });

    $('#popupclose').click(function () {
        $('#imgcrop_modal').modal('hide');
        $('#ImageErrorMessage').removeClass("hide").text("");
    })

    var myBookId;
    $(document).on("click", ".event_upldnew", function () {
        myBookId = $(this).data('id');
    });

    $(function () {
        $('.image-editor').cropit({
            exportZoom: 1.25,
            imageBackground: true,
            imageBackgroundBorderWidth: 20,
            imageState: {
                src: 'http://lorempixel.com/500/400/',
            },
        });

        $('.rotate-cw').click(function () {
            $('.image-editor').cropit('rotateCW');
        });

        $('.rotate-ccw').click(function () {
            $('.image-editor').cropit('rotateCCW');
        });

        $('.export').click(function () {
            var imageData = $('.image-editor').cropit('export');
            document.getElementById('output' + myBookId).src = imageData;
            var data = imageData.replace(/^data:image\/\w+;base64,/, "");
            document.getElementById('hdoutput' + myBookId).value = data;
            $('#imgcrop_modal').modal('hide');
            document.getElementById("fucrop").value = "";
            document.getElementById("croprange").value = "";
            $("#cropdiv img").attr("src", "img.png");
        });
    });
</script>
